[phases.setup]
nixPkgs = ["nodejs", "python311"]

[phases.install]
cmds = [
    "npm install",
    "rm -rf dist || true",
    "npm run build",
    "ls -la dist || echo 'dist directory listing:'",
    "ls -la dist/assets 2>/dev/null || echo 'assets directory does not exist yet'",
    "pip install --upgrade pip",
    "pip install -r requirements.txt"
]

[start]
cmd = "gunicorn wsgi:application --chdir ./src/ --bind 0.0.0.0:$PORT"

